#!/usr/bin/python

import sys
import os.path
from testrunhelper import TestRunHelper

class ReftestHelper(TestRunHelper):
  def __init__(self):
    PASSTHROUGH_ARGS = [
      '--extra-profile-file',
      '--install-extension',
      '--log-file',
      '--timeout',
      '--debugger',
      '--debugger-args',
      '--debugger-interactive'
    ]

    TestRunHelper.__init__(self, 'reftest/runreftest.py',
                           lambda g: g['ReftestOptions'](g['Automation']()),
                           pass_args=PASSTHROUGH_ARGS,
                           root='/@MOZ_TESTDIR@',
                           need_x=True, need_dbus=True)

def main():
  DEFAULTS = {
    '--appname': lambda: os.path.join(helper.root, 'bin', '@MOZ_APP_NAME@'),
    '--utility-path': lambda: os.path.join(helper.root, 'bin')
  }

  helper = ReftestHelper()
  sys.exit(helper.run(defaults=DEFAULTS))

if __name__ == '__main__':
  main()
