# HG changeset patch
# Parent b735e618c2a860972197942f6680c941e3c9a67f
# User Gustavo Luiz Duarte <gustavold@linux.vnet.ibm.com>
Bug 997353 - Do not use compile-time page size for PowerPC.

The PowerPC architecture allows various memory page sizes, making it impossible
to predict the runtime page size.

diff --git a/memory/build/mozjemalloc.cpp b/memory/build/mozjemalloc.cpp
--- a/memory/build/mozjemalloc.cpp
+++ b/memory/build/mozjemalloc.cpp
@@ -1083,17 +1083,18 @@ struct arena_s {
 #define	RUN_MAX_OVRHD		0x0000003dU
 #define	RUN_MAX_OVRHD_RELAX	0x00001800U
 
 /*
  * When MALLOC_STATIC_SIZES is defined most of the parameters
  * controlling the malloc behavior are defined as compile-time constants
  * for best performance and cannot be altered at runtime.
  */
-#if !defined(__ia64__) && !defined(__sparc__) && !defined(__mips__) && !defined(__aarch64__)
+#if !defined(__ia64__) && !defined(__sparc__) && !defined(__mips__) && !defined(__aarch64__) && \
+    !defined(__powerpc__) && !defined(__powerpc64__)
 #define MALLOC_STATIC_SIZES 1
 #endif
 
 #ifdef MALLOC_STATIC_SIZES
 
 /*
  * VM page size. It must divide the runtime CPU page size or the code
  * will abort.
