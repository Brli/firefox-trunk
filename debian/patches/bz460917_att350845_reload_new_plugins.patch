---
 browser/base/content/browser.js |   21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)

Index: mozilla/browser/base/content/browser.js
===================================================================
--- mozilla.orig/browser/base/content/browser.js
+++ mozilla/browser/base/content/browser.js
@@ -6006,22 +6006,30 @@
   installSinglePlugin: function (aEvent) {
     if (!aEvent.isTrusted)
         return;
     var missingPluginsArray = {};
 
     var pluginInfo = getPluginInfo(aEvent.target);
     missingPluginsArray[pluginInfo.mimetype] = pluginInfo;
 
+    gBrowser.selectedBrowser.addEventListener("NewPluginInstalled",
+                                              gMissingPluginInstaller.refreshBrowser,
+                                              false);
+
     if (missingPluginsArray) {
       openDialog("chrome://mozapps/content/plugins/pluginInstallerWizard.xul",
                  "PFSWindow", "chrome,centerscreen,resizable=yes",
                  {plugins: missingPluginsArray, browser: gBrowser.selectedBrowser});
     }
 
+    gBrowser.selectedBrowser.removeEventListener("NewPluginInstalled",
+                                                 gMissingPluginInstaller.refreshBrowser,
+                                                 false);
+
     aEvent.stopPropagation();
   },
 
   managePlugins: function (aEvent) {
     if (!aEvent.isTrusted)
         return;
     BrowserOpenAddonsMgr("plugins");
     aEvent.stopPropagation();
@@ -6089,21 +6097,27 @@
       var url = formatURL("plugins.update.url", true);
       gBrowser.loadOneTab(url, {inBackground: false});
       return true;
     }
 
     function showPluginsMissing() {
       // get the urls of missing plugins
       var missingPluginsArray = gBrowser.selectedBrowser.missingPlugins;
+      gBrowser.selectedBrowser.addEventListener("NewPluginInstalled",
+                                                gMissingPluginInstaller.refreshBrowser,
+                                                false);
       if (missingPluginsArray) {
         openDialog("chrome://mozapps/content/plugins/pluginInstallerWizard.xul",
                    "PFSWindow", "chrome,centerscreen,resizable=yes",
                    {plugins: missingPluginsArray, browser: gBrowser.selectedBrowser});
       }
+      gBrowser.selectedBrowser.removeEventListener("NewPluginInstalled",
+                                                   gMissingPluginInstaller.refreshBrowser,
+                                                   false);
     }
 
     if (aEvent.type == "PluginBlocklisted") {
       if (blockedNotification || missingNotification)
         return;
 
       let iconURL = "chrome://mozapps/skin/plugins/pluginBlocked-16.png";
       let messageString = gNavigatorBundle.getString("blockedpluginsMessage.title");
@@ -6309,16 +6323,23 @@
 
     // clear the plugin list, now that at least one plugin has been installed
     browser.missingPlugins = null;
     if (notification) {
       // reset UI
       notificationBox.removeNotification(notification);
     }
     // reload the browser to make the new plugin show.
+
+    // reload plugins
+    var pm = Components.classes["@mozilla.org/plugin/manager;1"]
+                 .getService(Components.interfaces.nsIPluginManager);
+    pm.reloadPlugins(false);
+  
+    // ... and reload the browser to activate new plugins available
     browser.reload();
   }
 };
 
 function convertFromUnicode(charset, str)
 {
   try {
     var unicodeConverter = Components
